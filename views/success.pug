doctype html
html(lang="en")
  head
    title=pageTitle
    script(type='text/javascript' src='https://s3.amazonaws.com/mturk-public/externalHIT_v1.js')
    //script(type='text/javascript' src='https://pages.runbam.com/hh.js')
    link(rel="stylesheet" type="text/css" href="https://button.glitch.me/css/glitch.css")
    link(rel="stylesheet" type="text/css" href="https://button.glitch.me/css/button.css")
    script(src="https://sdk.amazonaws.com/js/aws-sdk-2.218.1.min.js")


  body
    h1 Welcome
    div
      h2 What we know about you:
      dl
        dt id
        dd #{u.id}
        dt sub
        dd #{u.sub}
        dt token
        dd #{u.token}
        dt displayName
        dd #{u.displayName}
        dt nickname
        dd #{u.nickname}
        dt provider
        dd #{u.provider}
        dt email
        dd #{u.email}
        dt emails:
        if u.emails
          each email in u.emails
            dd= email.value
      a(href='/logoff') <b>Logoff</b>

    div    
      h2 An MTurk external hit:
      form(method='POST' action='https://workersandbox.mturk.com/mturk/externalSubmit')
        div
          p something to say:
          input(name="x")
        div
          p assignment id:
          input(id="assignmentId" name="assignmentId")
        div
          button.btn.btn-primary(type='submit') Done     

      script.
        turkSetAssignmentID();

          // RoleArn: 'arn:aws:iam::645086751203:role/Cognito_wrenid003Auth_Role',

    div
      h2 cognito stuff
      script.


        AWS.config.region = 'us-east-1';
      
        let ci = new AWS.CognitoIdentity();
        var params = {
          AccountId: "645086751203",
          IdentityPoolId: 'us-east-1:465d31f6-b82b-47d8-b29a-048a5bcd5865',
          Logins: {
            'cognito-idp.us-east-1.amazonaws.com/us-east-1_exRT8uV5e': "#{u.token}",
          }
        };
        
        ci.getId(params, function(err, data) {
          if (err) {
            console.error(err, err.stack);
          }
          else {
            console.log(JSON.stringify(data));
          }
        });
        
//        console.log("good_token: " + good_token);
        
        //ci.getCredentialsForIdentity


